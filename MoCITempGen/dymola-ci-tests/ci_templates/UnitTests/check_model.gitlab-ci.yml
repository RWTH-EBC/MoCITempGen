# dym_image_name: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda# ci_stage_model_check: model_check# ci_stage_create_whitelist: create_model_whitelist# commit_string: $CI_COMMIT_MESSAGE  !~ /ci_update_ref/   && $CI_COMMIT_MESSAGE  !~ /ci_show_ref/ && $CI_COMMIT_MESSAGE  !~ /ci_dif_ref/ && $CI_COMMIT_MESSAGE  !~ /ci_create_model_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_create_html_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_create_example_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_simulate/ && $CI_COMMIT_MESSAGE  !~ /ci_om_simulate/ && $CI_COMMIT_MESSAGE  !~ /ci_check/ && $CI_COMMIT_MESSAGE  !~ /ci_om_check/ && $CI_COMMIT_MESSAGE  !~ /ci_regression_test/ && $CI_COMMIT_MESSAGE  !~ /ci_html/ && $CI_COMMIT_MESSAGE  !~ /ci_setting/ && $CI_COMMIT_MESSAGE  !~ /ci_style_check/ && $CI_COMMIT_MESSAGE  !~ /ci_trigger_ibpsa/ && $CI_COMMIT_MESSAGE  !~ /ci_merge_except/ && $CI_COMMIT_MESSAGE  !~ /ci_correct_html/ && $CI_COMMIT_MESSAGE  !~ /ci_build_structure/ && $CI_COMMIT_MESSAGE  !~ /ci_build_whitelist/# library: AixLib# PR_main_branch_rule: $CI_COMMIT_BRANCH  == /main/   || $CI_COMMIT_BRANCH  == /development/# ci_check_commit: ci_check# dymola_python_test_url: --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git# dymola_python_dir: MoCITempGen/ci_tests# xvfb_flag: xvfb-run -n 77# dymola_python_test_validate_file: MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py# result_dir: dymola-ci-tests/result# expire_in_time: 7h# ci_create_model_wh_commit: ci_create_model_wh# arg_push: --dym-options DYM_CHECK --filter-wh-flag  --changed-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages $lib_package --library  AixLib  # config_ci_exit_file: dymola-ci-tests/Configfiles/exit.sh# bot_update_model_wh_commit: CI message from ebc-aixlib-bot. Update file dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt. Please pull the new files before push again.# wh_model_file: dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt# arg_wh: --git-url https://github.com/ibpsa/modelica-ibpsa.git --repo-dir modelica-ibpsa --dym-options DYM_CHECK --create-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --library  AixLib  # arg_PR: --dym-options DYM_CHECK --filter-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages $lib_package --library  AixLib  # python_version myenv# package_list: ['Airflow', 'BoundaryConditions', 'Controls', 'Electrical', 'Fluid', 'Media', 'Systems', 'ThermalZones', 'Utilities']# config_ci_changed_file: dymola-ci-tests/Configfiles/ci_changed_model_list.txt# dymola_python_config_structure_file: MoCITempGen/ci_tests/structure/config_structure.py# dymola_python_test_dir : D:\02_Git\MoCITempGenstages:    - model_check    - create_model_whitelist.check_rules:PR:    rules:        - if: $CI_PIPELINE_SOURCE == "external_pull_request_event"  &&  $CI_COMMIT_MESSAGE  !~ /ci_update_ref/   && $CI_COMMIT_MESSAGE  !~ /ci_show_ref/ && $CI_COMMIT_MESSAGE  !~ /ci_dif_ref/ && $CI_COMMIT_MESSAGE  !~ /ci_create_model_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_create_html_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_create_example_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_simulate/ && $CI_COMMIT_MESSAGE  !~ /ci_om_simulate/ && $CI_COMMIT_MESSAGE  !~ /ci_check/ && $CI_COMMIT_MESSAGE  !~ /ci_om_check/ && $CI_COMMIT_MESSAGE  !~ /ci_regression_test/ && $CI_COMMIT_MESSAGE  !~ /ci_html/ && $CI_COMMIT_MESSAGE  !~ /ci_setting/ && $CI_COMMIT_MESSAGE  !~ /ci_style_check/ && $CI_COMMIT_MESSAGE  !~ /ci_trigger_ibpsa/ && $CI_COMMIT_MESSAGE  !~ /ci_merge_except/ && $CI_COMMIT_MESSAGE  !~ /ci_correct_html/ && $CI_COMMIT_MESSAGE  !~ /ci_build_structure/ && $CI_COMMIT_MESSAGE  !~ /ci_build_whitelist/          when: on_success        - if: $CI_PIPELINE_SOURCE == "push"  && ($CI_COMMIT_BRANCH  == /main/   || $CI_COMMIT_BRANCH  == /development/)          when: on_success        - if: $CI_COMMIT_MESSAGE  =~ /ci_check/ && $CI_PIPELINE_SOURCE == "push"          when: always.check_rules:push:    rules:        - if: $CI_PIPELINE_SOURCE == "push"  &&  $CI_COMMIT_MESSAGE  !~ /ci_update_ref/   && $CI_COMMIT_MESSAGE  !~ /ci_show_ref/ && $CI_COMMIT_MESSAGE  !~ /ci_dif_ref/ && $CI_COMMIT_MESSAGE  !~ /ci_create_model_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_create_html_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_create_example_wh/ && $CI_COMMIT_MESSAGE  !~ /ci_simulate/ && $CI_COMMIT_MESSAGE  !~ /ci_om_simulate/ && $CI_COMMIT_MESSAGE  !~ /ci_check/ && $CI_COMMIT_MESSAGE  !~ /ci_om_check/ && $CI_COMMIT_MESSAGE  !~ /ci_regression_test/ && $CI_COMMIT_MESSAGE  !~ /ci_html/ && $CI_COMMIT_MESSAGE  !~ /ci_setting/ && $CI_COMMIT_MESSAGE  !~ /ci_style_check/ && $CI_COMMIT_MESSAGE  !~ /ci_trigger_ibpsa/ && $CI_COMMIT_MESSAGE  !~ /ci_merge_except/ && $CI_COMMIT_MESSAGE  !~ /ci_correct_html/ && $CI_COMMIT_MESSAGE  !~ /ci_build_structure/ && $CI_COMMIT_MESSAGE  !~ /ci_build_whitelist/          when: on_success        - if:  ($CI_COMMIT_BRANCH  == /main/   || $CI_COMMIT_BRANCH  == /development/)          when: never.check_model_job:PR:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: model_check    before_script:        - source activate myenv        - git clone --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git        - pip install -e  D:\02_Git\MoCITempGen    script:        - xvfb-run -n 77 python MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py  --dym-options DYM_CHECK --filter-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages $lib_package --library  AixLib      artifacts:        when: on_failure        paths:            - dymola-ci-tests/result/        expire_in: 7h    rules:        - !reference [.check_rules:PR , rules].check_model_job:Push:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: model_check    before_script:        - source activate myenv        - git clone --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git        - pip install -e  D:\02_Git\MoCITempGen    script:        - python MoCITempGen/ci_tests/structure/config_structure.py --changed-model        - git diff --raw --diff-filter=AMT HEAD^1 >  dymola-ci-tests/Configfiles/ci_changed_model_list.txt        - xvfb-run -n 77 python MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py  --dym-options DYM_CHECK --filter-wh-flag  --changed-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages $lib_package --library  AixLib      artifacts:        when: on_failure        paths:            - dymola-ci-tests/result/        expire_in: 7h    rules:        - !reference [.check_rules:push , rules]Check_AixLib_Airflow:PR:    variables:        lib_package: Airflow    extends: .check_model_job:PRCheck_AixLib_BoundaryConditions:PR:    variables:        lib_package: BoundaryConditions    extends: .check_model_job:PRCheck_AixLib_Controls:PR:    variables:        lib_package: Controls    extends: .check_model_job:PRCheck_AixLib_Electrical:PR:    variables:        lib_package: Electrical    extends: .check_model_job:PRCheck_AixLib_Fluid:PR:    variables:        lib_package: Fluid    extends: .check_model_job:PRCheck_AixLib_Media:PR:    variables:        lib_package: Media    extends: .check_model_job:PRCheck_AixLib_Systems:PR:    variables:        lib_package: Systems    extends: .check_model_job:PRCheck_AixLib_ThermalZones:PR:    variables:        lib_package: ThermalZones    extends: .check_model_job:PRCheck_AixLib_Utilities:PR:    variables:        lib_package: Utilities    extends: .check_model_job:PRCheck_AixLib_Airflow:Push:    variables:        lib_package: Airflow    extends: .check_model_job:PushCheck_AixLib_BoundaryConditions:Push:    variables:        lib_package: BoundaryConditions    extends: .check_model_job:PushCheck_AixLib_Controls:Push:    variables:        lib_package: Controls    extends: .check_model_job:PushCheck_AixLib_Electrical:Push:    variables:        lib_package: Electrical    extends: .check_model_job:PushCheck_AixLib_Fluid:Push:    variables:        lib_package: Fluid    extends: .check_model_job:PushCheck_AixLib_Media:Push:    variables:        lib_package: Media    extends: .check_model_job:PushCheck_AixLib_Systems:Push:    variables:        lib_package: Systems    extends: .check_model_job:PushCheck_AixLib_ThermalZones:Push:    variables:        lib_package: ThermalZones    extends: .check_model_job:PushCheck_AixLib_Utilities:Push:    variables:        lib_package: Utilities    extends: .check_model_job:Pushcheck_whitelist_job:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: create_model_whitelist    before_script:        - source activate myenv        - 'which ssh-agent || ( apt-get update -y && apt-get install openssh-client -y)'        - eval $(ssh-agent -s)        - mkdir -p ~/.ssh        - ssh-keyscan github.com >> ~/.ssh/known_hosts        - ssh-agent -a /tmp/ssh_agent.sock > /dev/null        - echo "$GITHUB_PRIVATE_KEY" > ~/.ssh/id_rsa        - chmod 600 ~/.ssh/id_rsa        - git config --global user.name "$GITLAB_USER_NAME"        - git config --global user.email "$GITLAB_USER_EMAIL"    script:        - mkdir whitelist && cd whitelist        - git clone --single-branch --branch $CI_COMMIT_REF_NAME git@github.com:$Github_Repository.git        - cd $CI_PROJECT_NAME && git clone --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git        - pip install -e  D:\02_Git\MoCITempGen        - xvfb-run -n 77 python MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py  --git-url https://github.com/ibpsa/modelica-ibpsa.git --repo-dir modelica-ibpsa --dym-options DYM_CHECK --create-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --library  AixLib      after_script:        - cd whitelist && cd $CI_PROJECT_NAME        - if cat dymola-ci-tests/Configfiles/exit.sh | grep "FAIL"; then            message="CI message from ebc-aixlib-bot. Update file dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt. Please pull the new files before push again." ;            git add dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt ;            git commit -m "$message" ;            git push git@github.com:$Github_Repository.git;            exit 0;          else            exit 0 ;          fi    artifacts:        paths:            - dymola-ci-tests/result/        expire_in: 7h    rules:        - if: $CI_COMMIT_MESSAGE =~ /ci_create_model_wh/ && $CI_PIPELINE_SOURCE == "push"          when: always
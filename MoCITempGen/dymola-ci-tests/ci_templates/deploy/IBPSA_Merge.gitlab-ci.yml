# ci_stage_lib_merge : merge# ci_stage_update_whitelist : update_whiteList# ci_stage_open_PR : open_PR# image_name : registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda# python_version : myenv# dymola_python_test_url : --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git# git_url : myenv# library : AixLib# merge_branch : IBPSA_Merge# dymola_python_library_merge_file : MoCITempGen/ci_tests/deploy/IBPSA_Merge/library_merge.py# arg_lib : --merge-library IBPSA --library  AixLib  --mos-path Convertmos --merge-library-dir modelica-ibpsa\IBPSA\Resources\Scripts\Dymola\ConvertIBPSA_* --library-dir AixLib\Resources\Scripts # ci_trigger_ibpsa_commit : ci_trigger_ibpsa# expire_in_time : 7h# dymola_python_html_tidy_file : MoCITempGen/ci_tests/SyntaxTests/html_tidy_errors.py# arg_wh_html : --whitelist-flag  --repo-dir modelica-ibpsa --git-url https://github.com/ibpsa/modelica-ibpsa.git --wh-library  IBPSA  --library  AixLib  # arg_wh_check : --git-url https://github.com/ibpsa/modelica-ibpsa.git --repo-dir modelica-ibpsa --dym-options DYM_CHECK --create-wh-flag  --extended-ex-flag  --filter-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages  Airflow  BoundaryConditions  Controls  Electrical  Fluid  Media  Systems  ThermalZones  Utilities  --library  AixLib  # arg_wh_sim : --git-url https://github.com/ibpsa/modelica-ibpsa.git --repo-dir modelica-ibpsa --dym-options DYM_SIM --create-wh-flag  --extended-ex-flag  --filter-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages  Airflow  BoundaryConditions  Controls  Electrical  Fluid  Media  Systems  ThermalZones  Utilities  --library  AixLib  # dymola_python_test_validate_file : MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py# xvfb_flag : xvfb-run -n 77# arg_lock :  --lock-library IBPSA --library  AixLib  # dymola_python_lock_model_file : MoCITempGen/CITests/Converter/lock_model.py# wh_library : IBPSA# bot_merge_commit : CI message from ebc-aixlib-bot. Merge of IBPSA library. Update files dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt and dymola-ci-tests/ci_whitelist/ci_html_whitelist.txt# result_dir : dymola-ci-tests/result# dymola_python_api_github_file : MoCITempGen/ci_tests/api_script/api_github.py# arg_api_pr : --lock-library IBPSA --library  AixLib  # dymola_python_dir: MoCITempGen/ci_testsstages:    - merge    - update_whiteList    - open_PRIBPSA:    image: registry.git.rwth-aachen.de/ebc/ebc_intern/dymola-docker:Dymola_2022-miniconda    stage: merge    before_script:        - source activate myenv        - 'which ssh-agent || ( apt-get update -y && apt-get install openssh-client -y )'        - eval $(ssh-agent -s)        - mkdir -p ~/.ssh        - ssh-keyscan github.com >> ~/.ssh/known_hosts        - ssh-agent -a /tmp/ssh_agent.sock > /dev/null        - echo "$GITHUB_PRIVATE_KEY" > ~/.ssh/id_rsa        - chmod 600 ~/.ssh/id_rsa        - git config --global user.name "$GITLAB_USER_NAME"        - git config --global user.email "$GITLAB_USER_EMAIL"        - git clone --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git        - pip install -e  D:\02_Git\MoCITempGen    script:        - git clone --single-branch --branch  IBPSA_Merge git@github.com:$Github_Repository.git        - cd $CI_PROJECT_NAME        - git clone myenv        - cd AixLib/Resources/Scripts        - python mergeModelicaIBPSA.py        - cd ../../..  && python MoCITempGen/ci_tests/deploy/IBPSA_Merge/library_merge.py  --merge-library IBPSA --library  AixLib  --mos-path Convertmos --merge-library-dir modelica-ibpsa\IBPSA\Resources\Scripts\Dymola\ConvertIBPSA_* --library-dir AixLib\Resources\Scripts         - rm -r modelica-ibpsa    rules:        - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH == /IBPSA_Merge/ &&   $CI_COMMIT_MESSAGE  =~ /ci_trigger_ibpsa/          when: always    artifacts:        paths:            - dymola-ci-tests/result/        expire_in: 7hWhiteList:    stage: update_whiteList    before_script:        - source activate myenv        - 'which ssh-agent || ( apt-get update -y && apt-get install openssh-client -y )'        - eval $(ssh-agent -s)        - mkdir -p ~/.ssh        - ssh-keyscan github.com >> ~/.ssh/known_hosts        - ssh-agent -a /tmp/ssh_agent.sock > /dev/null        - echo "$GITHUB_PRIVATE_KEY" > ~/.ssh/id_rsa        - chmod 600 ~/.ssh/id_rsa        - git config --global user.name "$GITLAB_USER_NAME"        - git config --global user.email "$GITLAB_USER_EMAIL"        - git clone --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git        - pip install -e  D:\02_Git\MoCITempGen    script:        - cd Merge_Package/$CI_PROJECT_NAME        - python MoCITempGen/ci_tests/SyntaxTests/html_tidy_errors.py --whitelist-flag  --repo-dir modelica-ibpsa --git-url https://github.com/ibpsa/modelica-ibpsa.git --wh-library  IBPSA  --library  AixLib          - xvfb-run -n 77 python MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py  --git-url https://github.com/ibpsa/modelica-ibpsa.git --repo-dir modelica-ibpsa --dym-options DYM_CHECK --create-wh-flag  --extended-ex-flag  --filter-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages  Airflow  BoundaryConditions  Controls  Electrical  Fluid  Media  Systems  ThermalZones  Utilities  --library  AixLib          - xvfb-run -n 77 python MoCITempGen/ci_tests/UnitTests/CheckPackages/validatetest.py  --git-url https://github.com/ibpsa/modelica-ibpsa.git --repo-dir modelica-ibpsa --dym-options DYM_SIM --create-wh-flag  --extended-ex-flag  --filter-wh-flag  --dymola-version 2022 --wh-library  IBPSA  --root-library  AixLib/package.mo  --packages  Airflow  BoundaryConditions  Controls  Electrical  Fluid  Media  Systems  ThermalZones  Utilities  --library  AixLib          - python MoCITempGen/CITests/Converter/lock_model.py   --lock-library IBPSA --library  AixLib          - rm  -r IBPSA        - message="CI message from ebc-aixlib-bot. Merge of IBPSA library. Update files dymola-ci-tests/ci_whitelist/ci_check_whitelist.txt and dymola-ci-tests/ci_whitelist/ci_html_whitelist.txt"        - push_model=$(git ls-files --others --exclude-standard --directory AixLib)        - git add  $push_model        - git commit -m "$message"        - git push --force git@github.com:$Github_Repository.git    rules:        - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH == /IBPSA_Merge/ &&   $CI_COMMIT_MESSAGE  =~ /ci_trigger_ibpsa/          when: always    artifacts:        paths:            - dymola-ci-tests/result/        expire_in: 7h    allow_failure: true    needs:    - job: IBPSA      artifacts: trueIBPSA_Pull_Request:    stage: open_PR    before_script:        - source activate myenv        - git config --global user.name "$GITLAB_USER_NAME"        - git config --global user.email "$GITLAB_USER_EMAIL"        - git clone --single-branch --branch 03_openModelica https://github.com/RWTH-EBC/MoCITempGen.git        - pip install -e  D:\02_Git\MoCITempGen    script:       - python  MoCITempGen/ci_tests/api_script/api_github.py --lock-library IBPSA --library  AixLib      rules:       - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH == /IBPSA_Merge/ &&   $CI_COMMIT_MESSAGE  =~ /ci_trigger_ibpsa/         when: always